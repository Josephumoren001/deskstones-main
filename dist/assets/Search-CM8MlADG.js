import{r as l,u as w,a as b,j as e,T as N,S as f,B as P,P as T}from"./index-CwG-bGP-.js";function U(){const[o,u]=l.useState({searchTerm:"",sort:"desc",category:"uncategorized"}),[h,x]=l.useState([]),[d,p]=l.useState(!1),[j,g]=l.useState(!1),c=w(),S=b();l.useEffect(()=>{const s={current:!0};return(async()=>{p(!0);const r=new URLSearchParams(c.search).toString();try{const a=await fetch(`/api/post/getposts?${r}`);if(!a.ok)throw new Error("Failed to fetch posts");const i=await a.json();s.current&&(x(i.posts),g(i.posts.length===9))}catch(a){console.error(a)}finally{s.current&&p(!1)}})(),()=>{s.current=!1}},[c.search]),l.useEffect(()=>{const s=new URLSearchParams(c.search),t=s.get("searchTerm")||"",n=s.get("sort")||"desc",r=s.get("category")||"uncategorized";u(a=>({...a,searchTerm:t,sort:n,category:r}))},[c.search]);const m=s=>{const{id:t,value:n}=s.target;u(r=>({...r,[t]:n}))},v=s=>{s.preventDefault();const t=new URLSearchParams(c.search);t.set("searchTerm",o.searchTerm),t.set("sort",o.sort),t.set("category",o.category),S(`/search?${t.toString()}`)},y=async()=>{const s=h.length,t=new URLSearchParams(c.search);t.set("startIndex",s);const n=t.toString();try{const r=await fetch(`/api/post/getposts?${n}`);if(!r.ok)throw new Error("Failed to fetch more posts");const a=await r.json();x(i=>[...i,...a.posts]),g(a.posts.length===9)}catch(r){console.error(r)}};return e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"p-7 border-b md:border-r md:min-h-screen border-gray-500",children:e.jsxs("form",{className:"flex flex-col gap-8",onSubmit:v,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"whitespace-nowrap font-semibold",children:"Search Term:"}),e.jsx(N,{placeholder:"Search...",id:"searchTerm",type:"text",value:o.searchTerm,onChange:m})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold",children:"Sort:"}),e.jsxs(f,{onChange:m,value:o.sort,id:"sort",children:[e.jsx("option",{value:"desc",children:"Latest"}),e.jsx("option",{value:"asc",children:"Oldest"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold",children:"Category:"}),e.jsxs(f,{onChange:m,value:o.category,id:"category",children:[e.jsx("option",{value:"uncategorized",children:"Uncategorized"}),e.jsx("option",{value:"reactjs",children:"React.js"}),e.jsx("option",{value:"nextjs",children:"Next.js"}),e.jsx("option",{value:"javascript",children:"JavaScript"})]})]}),e.jsx(P,{type:"submit",outline:!0,gradientDuoTone:"purpleToPink",children:"Apply Filters"})]})}),e.jsxs("div",{className:"w-full",children:[e.jsx("h1",{className:"text-3xl font-semibold sm:border-b border-gray-500 p-3 mt-5",children:"Posts results:"}),e.jsxs("div",{className:"p-7 flex flex-wrap gap-4",children:[!d&&h.length===0&&e.jsx("p",{className:"text-xl text-gray-500",children:"No posts found."}),d&&e.jsx("p",{className:"text-xl text-gray-500",children:"Loading..."}),!d&&h.map(s=>e.jsx(T,{post:s},s._id)),j&&e.jsx("button",{onClick:y,className:"text-teal-500 text-lg hover:underline p-7 w-full",children:"Show More"})]})]})]})}export{U as default};
